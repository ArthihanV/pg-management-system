{% extends 'base.html' %}

{% block title %}My Customers{% endblock %}

{% block sidebar %}
<li><a href="{% url 'dashboard' %}"><i class="fa-solid fa-chart-line"></i>Dashboard</a></li>
<li><a href="{% url 'add_pg' %}"><i class="fa-solid fa-plus"></i>Add PG</a></li>
<li><a href="{% url 'owner_customers' %}"><i class="fa-solid fa-users"></i>My Customers</a></li>
<li><a href="{% url 'owner_pg_list' %}"><i class="fa-solid fa-building"></i>Manage PG</a></li>
<li><a href="{% url 'owner_bookings' %}"><i class="fa-solid fa-calendar-check"></i>Booking Requests</a></li>
<li><a href="{% url 'owner_booking_history' %}"><i class="fa-solid fa-history"></i>Booking History</a></li>
{% endblock %}

{% block content %}
<div class="page-header">
    <h2>My Customers</h2>
    <p>Customers who booked your PGs</p>
</div>

<table class="table">
    <tr>
        <th>Customer</th>
        <th>PG</th>
        <th>Room</th>
        <th>Status</th>
        <th>Action</th>
    </tr>

    {% for b in bookings %}
    <tr>
        <td>{{ b.customer.username }}</td>
        <td>{{ b.room.pg.name }}</td>
        <td>{{ b.room.room_type }}</td>
        <td>
            {% if b.status == 'APPROVED' %}
                <span class="badge approved">Approved</span>
            {% elif b.status == 'PENDING' %}
                <span class="badge pending">Pending</span>
            {% else %}
                <span class="badge rejected">Rejected</span>
            {% endif %}
        </td>
        <td>
            <form method="post" action="{% url 'owner_remove_customer' b.id %}">
                {% csrf_token %}
                <button
                    type="submit"
                    class="btn small danger"
                    onclick="return confirm('Remove this customer booking?')"
                >
                    Remove
                </button>
            </form>
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="5">No customers yet</td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
